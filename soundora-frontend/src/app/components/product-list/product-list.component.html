<!-- 
  =====================================
  TEMPLATE DE LISTE DE PRODUITS -         <!-- FILTRE : S√©lection de marque -->
        <div class="filter-group">
          <label for="brand">Marque</label>
          <!-- 
            LOGIQUE IDENTIQUE AU FILTRE CAT√âGORIE :
            - [(ngModel)]="selectedBrand" : Stockage de la marque s√©lectionn√©e
            - (change)="onBrandChange()" : Filtrage imm√©diat √† la s√©lection
            - Option vide pour "Toutes les marques"
          -->
          <select 
            id="brand"
            class="form-control" 
            [(ngModel)]="selectedBrand" 
            (change)="onBrandChange()">
            <option value="">Toutes les marques</option>
            <option *ngFor="let brand of brands" [value]="brand.slug">
              {{ brand.name }}
            </option>
          </select>
        </div>

        <!-- FILTRE : Fourchette de prix -->
        <div class="filter-group">
          <label>Prix</label>
          <!-- 
            SYST√àME DE FOURCHETTE PRIX :
            - Deux inputs : prix minimum et maximum
            - (blur) : D√©clenche le filtrage quand l'utilisateur quitte le champ
            - Validation c√¥t√© TypeScript pour s'assurer que min < max
          -->
          <div class="price-range">
            <!--  Prix minimum -->============================
  Affichage des produits avec filtres, pagination et syst√®me de panier
  Includes: Hero section, filtres lat√©raux, grille de produits, notifications
-->

<!-- Section Hero optimis√©e - VERSION MINI pour les listes de produits -->
<!-- Utilise une classe CSS sp√©cifique pour r√©duire la hauteur -->
<section class="hero-section-mini">
  <div class="hero-content">
    <h1>Bienvenue chez Soundora</h1>
    <p>Votre boutique d'instruments de musique de r√©f√©rence</p>
  </div>
</section>

<!-- Conteneur principal avec syst√®me de grille Bootstrap -->
<div class="container">
  <div class="row">
    
    <!-- =====================================
         EN-T√äTE DE SECTION
         ===================================== -->
    <!-- Titre dynamique bas√© sur les filtres actifs -->
    <div class="col-12 mb-4">
      <!-- pageTitle : D√©termin√© dans le TypeScript selon le contexte -->
      <!-- Exemples : "Tous les produits", "Guitares", "Produits Fender" -->
      <h2 class="section-title">{{ pageTitle }}</h2>
      <div class="title-divider"></div>
    </div>
    
    <!-- =====================================
         PANNEAU DE FILTRES LAT√âRAL
         ===================================== -->
    <div class="col-md-3">
      <div class="filters-panel">
        <h4>Filtres</h4>
        
        <!-- FILTRE : Barre de recherche textuelle -->
        <div class="filter-group">
          <label for="search">Recherche</label>
          <!-- 
            FONCTIONNALIT√âS :
            - [(ngModel)]="searchQuery" : Liaison bidirectionnelle avec la propri√©t√© TypeScript
            - (keyup.enter) : Recherche instantan√©e quand l'utilisateur appuie sur Entr√©e
            - (click) sur bouton : Recherche au clic
          -->
          <input 
            type="text" 
            id="search"
            class="form-control"
            [(ngModel)]="searchQuery" 
            (keyup.enter)="onSearch()"
            placeholder="Chercher un produit...">
          <button class="btn btn-primary btn-sm mt-1" (click)="onSearch()">üîç</button>
        </div>

        <!-- FILTRE : S√©lection de cat√©gorie -->
        <div class="filter-group">
          <label for="category">Cat√©gorie</label>
          <!-- 
            FONCTIONNEMENT :
            - [(ngModel)]="selectedCategory" : Valeur s√©lectionn√©e stock√©e dans la propri√©t√©
            - (change)="onCategoryChange()" : D√©clenche le filtrage imm√©diat
            - *ngFor : Boucle sur les cat√©gories r√©cup√©r√©es de l'API
            - [value]="category.slug" : Utilise le slug comme identifiant unique
          -->
          <select 
            id="category"
            class="form-control" 
            [(ngModel)]="selectedCategory" 
            (change)="onCategoryChange()">
            <option value="">Toutes les cat√©gories</option>
            <option *ngFor="let category of categories" [value]="category.slug">
              {{ category.name }}
            </option>
          </select>
        </div>

        <!-- FILTRE : S√©lection de marque -->
        <div class="filter-group">
          <label for="brand">Marque</label>
          <select 
            id="brand"
            class="form-control" 
            [(ngModel)]="selectedBrand" 
            (change)="onBrandChange()">
            <option value="">Toutes les marques</option>
            <option *ngFor="let brand of brands" [value]="brand.slug">
              {{ brand.name }}
            </option>
          </select>
        </div>

        <!-- Prix -->
        <div class="filter-group">
          <label>Prix</label>
          <div class="price-range">
            <!--  Prix minimum -->
            <input 
              type="number" 
              class="form-control form-control-sm"
              [(ngModel)]="priceMin" 
              placeholder="Min ‚Ç¨"
              (change)="onPriceFilter()">
            <span>-</span>
            <!-- Prix maximum -->
            <input 
              type="number" 
              class="form-control form-control-sm"
              [(ngModel)]="priceMax" 
              placeholder="Max ‚Ç¨"
              (change)="onPriceFilter()">
          </div>
        </div>

        <!-- BOUTON : R√©initialisation des filtres -->
        <!-- 
          FONCTION : clearFilters() remet tous les filtres √† leurs valeurs par d√©faut
          UTILIT√â : Permet √† l'utilisateur de retrouver rapidement l'affichage complet
        -->
        <button class="btn btn-secondary btn-sm" (click)="clearFilters()">
         Effacer les filtres
        </button>
      </div>
    </div>

    <!-- =====================================
         ZONE D'AFFICHAGE DES PRODUITS
         ===================================== -->
    <div class="col-md-9">
      
      <!-- EN-T√äTE avec compteur de r√©sultats -->
      <div class="products-header">
        <h2>üé∏ Nos Instruments</h2>
        <!-- 
          COMPTEUR DYNAMIQUE :
          - Affiche le nombre total de produits trouv√©s
          - G√®re le pluriel automatiquement (produit/produits, trouv√©/trouv√©s)
          - Masqu√© pendant le chargement (*ngIf="!loading")
        -->
        <div class="results-info" *ngIf="!loading">
          {{ totalItems }} produit{{ totalItems > 1 ? 's' : '' }} trouv√©{{ totalItems > 1 ? 's' : '' }}
        </div>
      </div>

      <!-- INDICATEUR DE CHARGEMENT -->
      <!-- Spinner Bootstrap affich√© uniquement pendant les requ√™tes API -->
      <div *ngIf="loading" class="text-center">
        <div class="spinner-border" role="status">
          <span class="visually-hidden">Chargement...</span>
        </div>
      </div>

      <!-- =====================================
           GRILLE DE PRODUITS PRINCIPALE
           ===================================== -->
      <!-- Masqu√©e pendant le chargement pour √©viter le scintillement -->
      <div class="products-grid" *ngIf="!loading">
        <!-- 
          OPTIMISATION CRITIQUE : trackBy: trackByProductId
          PROBL√àME R√âSOLU : √âvite le "saut" des noms de produits
          FONCTIONNEMENT : Angular utilise product.id pour identifier chaque √©l√©ment
          AVANTAGE : Pas de re-rendu inutile, performance am√©lior√©e
        -->
        <div class="product-card" *ngFor="let product of products; trackBy: trackByProductId" [routerLink]="['/product', product.slug]">
          
          <!-- SECTION : Image du produit -->
          <div class="product-image">
            <!-- 
              IMAGE AVEC FALLBACK :
              - [src]="getMainImage(product)" : R√©cup√®re l'image principale via m√©thode
              - onerror : Si l'image n'existe pas, affiche une image par d√©faut
              - [alt] : Texte alternatif pour l'accessibilit√©
            -->
            <img [src]="getMainImage(product)" [alt]="product.name" 
                 onerror="this.src='/assets/images/no-image.jpg'">
            <!-- Badge "Produit vedette" si is_featured est true -->
            <div class="product-featured" *ngIf="product.is_featured">‚≠ê</div>
          </div>

          <!-- SECTION : Informations du produit -->
          <div class="product-info">
            <!-- Marque (si disponible via relation brands) -->
            <div class="product-brand" *ngIf="product.brands?.name">{{ product.brands.name }}</div>
            <!-- Nom du produit (titre principal) -->
            <h5 class="product-name">{{ product.name }}</h5>
            <!-- Description courte -->
            <p class="product-description">{{ product.short_description }}</p>
            
            <!-- SECTION : Affichage des prix -->
            <div class="product-pricing">
              <!-- Prix actuel (toujours affich√©) -->
              <span class="current-price">{{ formatPrice(product.price) }}</span>
              <!-- Prix de comparaison (ancien prix si en promotion) -->
              <span class="original-price" *ngIf="product.compare_price">
                {{ formatPrice(product.compare_price) }}
              </span>
            </div>

            <!-- SECTION : M√©tadonn√©es du produit -->
            <div class="product-meta">
              <!-- 
                INDICATEUR DE STOCK :
                - [class.low-stock] : Applique une classe CSS sp√©ciale si stock <= 2
                - Affichage conditionnel pour alerter sur le stock faible
              -->
              <span class="stock" [class.low-stock]="product.stock <= 2">
               {{ product.stock }} en stock
              </span>
              <!-- Cat√©gorie du produit (si disponible via relation) -->
              <span class="category" *ngIf="product.categories?.name">{{ product.categories.name }}</span>
            </div>

            <!-- SECTION : D√©tails techniques (couleur, mod√®le) -->
            <div class="product-details" *ngIf="product.color || product.model">
              <!-- Couleur du produit (optionnel) -->
              <span *ngIf="product.color" class="color">{{ product.color }}</span>
              <!-- Mod√®le du produit (optionnel) -->
              <span *ngIf="product.model" class="model">{{ product.model }}</span>
            </div>
          </div>

          <!-- =====================================
               ACTIONS UTILISATEUR SUR LE PRODUIT
               ===================================== -->
          <div class="product-actions">
            <!-- 
              BOUTON AJOUT AU PANIER :
              - (click)="addToCart(product, $event)" : M√©thode d'ajout avec gestion d'√©v√©nement
              - $event : N√©cessaire pour √©viter la navigation vers la page d√©tail
              - [disabled] : D√©sactive le bouton si rupture de stock
              - Texte dynamique selon le stock
            -->
            <button class="btn btn-primary btn-sm" 
                    (click)="addToCart(product, $event)"
                    [disabled]="product.stock === 0">
              üõí {{ product.stock === 0 ? 'Rupture' : 'Ajouter au panier' }}
            </button>
            
            <!-- 
              BOUTON VOIR D√âTAILS :
              - [routerLink] : Navigation vers la page d√©tail du produit
              - Utilise le slug pour des URLs SEO-friendly
            -->
            <a [routerLink]="['/product', product.slug]" class="btn btn-outline-secondary btn-sm">
             Voir d√©tails
            </a>
          </div>
        </div>
      </div>

      <!-- =====================================
           MESSAGE AUCUN R√âSULTAT
           ===================================== -->
      <!-- Affich√© uniquement si pas de chargement ET aucun produit trouv√© -->
      <div *ngIf="!loading && products.length === 0" class="no-products">
        <h4>üîç Aucun produit trouv√©</h4>
        <p>Essayez de modifier vos filtres de recherche.</p>
      </div>

      <!-- =====================================
           SYST√àME DE PAGINATION
           ===================================== -->
      <!-- 
        AFFICHAGE CONDITIONNEL :
        - !loading : Masqu√© pendant le chargement
        - totalPages > 1 : Affich√© seulement si plusieurs pages disponibles
      -->
      <nav *ngIf="!loading && totalPages > 1" class="pagination-wrapper">
        <ul class="pagination justify-content-center">
          <!-- 
            BOUTON PAGE PR√âC√âDENTE :
            - [class.disabled] : Applique classe CSS si on est sur la premi√®re page
            - [disabled] : D√©sactive le bouton fonctionnellement
            - (click)="previousPage()" : M√©thode de navigation
          -->
          <li class="page-item" [class.disabled]="currentPage === 1">
            <button class="page-link" (click)="previousPage()" [disabled]="currentPage === 1">
              Pr√©c√©dent
            </button>
          </li>
          
          <!-- 
            NUM√âROS DE PAGES :
            - *ngFor="let page of getPagesArray()" : Boucle sur les num√©ros de pages
            - [class.active] : Surligne la page actuelle
            - (click)="goToPage(page)" : Navigation directe vers une page
          -->
          <li class="page-item" 
              *ngFor="let page of getPagesArray()" 
              [class.active]="currentPage === page">
            <button class="page-link" (click)="goToPage(page)">
              {{ page }}
            </button>
          </li>
          
          <!-- 
            BOUTON PAGE SUIVANTE :
            - Logique inverse du bouton pr√©c√©dent
            - D√©sactiv√© si on est sur la derni√®re page
          -->
          <li class="page-item" [class.disabled]="currentPage === totalPages">
            <button class="page-link" (click)="nextPage()" [disabled]="currentPage === totalPages">
              Suivant
            </button>
          </li>
        </ul>
      </nav>
    </div>
  </div>
</div>

<!-- 
  =====================================
  FIN DU TEMPLATE PRODUCT-LIST
  =====================================
  Structure compl√®te :
  1. Hero section mini
  2. Conteneur avec filtres lat√©raux (col-md-3)
  3. Zone principale des produits (col-md-9)
  4. Grille responsive avec cartes produits
  5. Syst√®me de pagination int√©gr√©
  
  Fonctionnalit√©s cl√©s :
  - Filtrage en temps r√©el (cat√©gorie, marque, prix, recherche)
  - Optimisation performance avec trackBy
  - Gestion d'√©tat (loading, aucun r√©sultat)
  - Navigation SEO-friendly avec slugs
  - Integration syst√®me de panier avec notifications
-->