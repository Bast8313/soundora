<!-- Navbar principale -->
<nav class="navbar">
  <div class="navbar-container">
    
    <!-- Logo -->
    <a routerLink="/" class="navbar-logo">
      <span class="logo-icon">üé∏</span>
      <span class="logo-text">Soundora</span>
    </a>

    <!-- Menu de navigation (desktop et mobile) -->
    <ul class="navbar-menu" [class.active]="isMenuOpen">
      <!-- Lien Accueil -->
      <li class="navbar-item">
        <a routerLink="/" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}" class="navbar-link" (click)="closeMenu()">
          Accueil
        </a>
      </li>

      <!-- Lien Produits -->
      <li class="navbar-item">
        <a routerLink="/products" routerLinkActive="active" class="navbar-link" (click)="closeMenu()">
          Produits
        </a>
      </li>

      <!-- Dropdown Cat√©gories -->
      <li class="navbar-item navbar-dropdown" 
          (mouseenter)="openCategoriesDropdown()"
          (mouseleave)="closeCategoriesDropdown()">
        <a class="navbar-link navbar-link-dropdown" 
           (click)="toggleCategoriesDropdown()">
          Cat√©gories
          <span class="dropdown-arrow">‚ñº</span>
        </a>
        
        <!-- Menu d√©roulant des cat√©gories -->
        <div class="dropdown-menu" [class.active]="isCategoriesDropdownOpen">
          <!-- Lien vers toutes les cat√©gories -->
          <a routerLink="/categories" class="dropdown-item" (click)="closeMenu()">
            <strong>Toutes les cat√©gories</strong>
          </a>
          <div class="dropdown-divider"></div>
          
          <!-- Liste des cat√©gories principales -->
          <ng-container *ngFor="let category of categories">
            <a [routerLink]="['/products']" 
               [queryParams]="{category: category.slug}" 
               class="dropdown-item dropdown-category" 
               (click)="closeMenu()">
              {{ category.name }}
            </a>
            
            <!-- Sous-cat√©gories -->
            <ng-container *ngIf="category.subcategories && category.subcategories.length > 0">
              <a *ngFor="let subcategory of category.subcategories"
                 [routerLink]="['/products']" 
                 [queryParams]="{category: subcategory.slug}" 
                 class="dropdown-item dropdown-subcategory" 
                 (click)="closeMenu()">
                {{ subcategory.name }}
              </a>
            </ng-container>
          </ng-container>
        </div>
      </li>

      <!-- Lien √Ä propos -->
      <li class="navbar-item">
        <a routerLink="/about" routerLinkActive="active" class="navbar-link" (click)="closeMenu()">
          √Ä propos
        </a>
      </li>
    </ul>

    <!-- Barre de recherche -->
    <div class="navbar-search">
      <input 
        type="text" 
        class="search-input" 
        placeholder="Rechercher un produit..."
        [(ngModel)]="searchQuery"
        (keyup.enter)="onSearch()">
      <button class="search-button" (click)="onSearch()">
        üîç
      </button>
    </div>

    <!-- Actions utilisateur (panier, connexion) -->
    <div class="navbar-actions">
      <!-- Panier avec badge compteur -->
      <a routerLink="/cart" class="navbar-icon-link" title="Panier">
        <span class="icon">üõí</span>
        <span class="badge" *ngIf="cartItemCount > 0">{{ cartItemCount }}</span>
      </a>

      <!-- Boutons Connexion/Inscription -->
      <div class="navbar-auth">
        <a routerLink="/login" class="btn-login">Connexion</a>
        <a routerLink="/register" class="btn-register">Inscription</a>
      </div>
    </div>

    <!-- Bouton burger pour mobile -->
    <button class="burger-menu" (click)="toggleMenu()" [class.active]="isMenuOpen">
      <span class="burger-line"></span>
      <span class="burger-line"></span>
      <span class="burger-line"></span>
    </button>

  </div>
</nav>
