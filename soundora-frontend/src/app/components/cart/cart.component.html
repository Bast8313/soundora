<!-- 
  ==========================================
  PAGE PANIER - cart.component.html
  ==========================================
  
  STRUCTURE :
  1. En-t√™te avec titre et bouton "Vider"
  2. Message de notification (si action effectu√©e)
  3. Liste des produits OU message "panier vide"
  4. R√©capitulatif et bouton de commande
  
  POUR LES √âTUDIANTS :
  - *ngIf : affiche ou masque un √©l√©ment selon une condition
  - *ngFor : r√©p√®te un √©l√©ment pour chaque item d'un tableau
  - (click) : √©coute l'√©v√©nement clic et appelle une m√©thode
  - [src] : lie dynamiquement la source d'une image
  - {{ }} : affiche une valeur du composant (interpolation)
-->

<div class="cart-container">
  
  <!-- ========================================
       EN-T√äTE DE LA PAGE
       ======================================== -->
  <div class="cart-header">
    <h1>üõí Mon Panier</h1>
    
    <!-- Bouton pour vider le panier (affich√© seulement si le panier n'est pas vide) -->
    <button 
      *ngIf="cartItems.length > 0" 
      class="btn-clear" 
      (click)="clearCart()">
      Vider le panier
    </button>
  </div>

  <!-- ========================================
       MESSAGE DE NOTIFICATION
       ======================================== -->
  <!-- 
    Ce message appara√Æt temporairement apr√®s une action
    (ajout, suppression, etc.)
  -->
  <div *ngIf="message" class="notification">
    {{ message }}
  </div>

  <!-- ========================================
       PANIER VIDE
       ======================================== -->
  <!-- 
    *ngIf="cartItems.length === 0" : s'affiche seulement si le panier est vide
  -->
  <div *ngIf="cartItems.length === 0" class="empty-cart">
    <div class="empty-cart-icon">üõí</div>
    <h2>Votre panier est vide</h2>
    <p>D√©couvrez notre catalogue et ajoutez des produits !</p>
    <a routerLink="/products" class="btn-primary">
      Voir les produits
    </a>
  </div>

  <!-- ========================================
       LISTE DES PRODUITS
       ======================================== -->
  <!-- 
    *ngIf="cartItems.length > 0" : s'affiche seulement si le panier contient des produits
    *ngFor="let item of cartItems" : cr√©e un √©l√©ment pour chaque produit
  -->
  <div *ngIf="cartItems.length > 0" class="cart-content">
    
    <!-- Tableau des produits -->
    <div class="cart-items">
      
      <!-- En-t√™te du tableau (visible sur desktop) -->
      <div class="cart-table-header">
        <span class="col-product">Produit</span>
        <span class="col-price">Prix</span>
        <span class="col-quantity">Quantit√©</span>
        <span class="col-subtotal">Sous-total</span>
        <span class="col-action">Action</span>
      </div>

      <!-- Boucle sur chaque article du panier -->
      <div class="cart-item" *ngFor="let item of cartItems">
        
        <!-- Image et nom du produit -->
        <div class="item-product">
          <img 
            [src]="getImagePath(item.image)" 
            [alt]="item.name"
            class="item-image"
            (error)="onImageError($event)">
          <div class="item-info">
            <h3 class="item-name">{{ item.name }}</h3>
            <a [routerLink]="['/products', item.slug]" class="item-link">
              Voir le produit
            </a>
          </div>
        </div>

        <!-- Prix unitaire -->
        <div class="item-price">
          <span class="mobile-label">Prix :</span>
          {{ item.price | number:'1.2-2' }} ‚Ç¨
        </div>

        <!-- Contr√¥le de quantit√© -->
        <div class="item-quantity">
          <span class="mobile-label">Quantit√© :</span>
          <div class="quantity-controls">
            <!-- Bouton - (diminuer) -->
            <button 
              class="qty-btn" 
              (click)="decreaseQuantity(item)"
              [disabled]="item.quantity <= 1">
              ‚àí
            </button>
            
            <!-- Affichage de la quantit√© -->
            <span class="qty-value">{{ item.quantity }}</span>
            
            <!-- Bouton + (augmenter) -->
            <button 
              class="qty-btn" 
              (click)="increaseQuantity(item)">
              +
            </button>
          </div>
        </div>

        <!-- Sous-total (prix √ó quantit√©) -->
        <div class="item-subtotal">
          <span class="mobile-label">Sous-total :</span>
          <strong>{{ item.price * item.quantity | number:'1.2-2' }} ‚Ç¨</strong>
        </div>

        <!-- Bouton supprimer -->
        <div class="item-action">
          <button 
            class="btn-remove" 
            (click)="removeItem(item)"
            title="Retirer du panier">
            üóëÔ∏è
          </button>
        </div>
      </div>

    </div>

    <!-- ========================================
         R√âCAPITULATIF ET COMMANDE
         ======================================== -->
    <div class="cart-summary">
      <h2>R√©capitulatif</h2>
      
      <div class="summary-line">
        <span>Nombre d'articles :</span>
        <span>{{ cartItems.length }}</span>
      </div>
      
      <div class="summary-line">
        <span>Sous-total :</span>
        <span>{{ cartTotal | number:'1.2-2' }} ‚Ç¨</span>
      </div>
      
      <div class="summary-line">
        <span>Livraison :</span>
        <span class="free-shipping">Gratuite</span>
      </div>
      
      <hr>
      
      <div class="summary-total">
        <span>Total :</span>
        <span class="total-price">{{ cartTotal | number:'1.2-2' }} ‚Ç¨</span>
      </div>

      <!-- Bouton de commande -->
      <button class="btn-checkout" (click)="checkout()">
        Commander
      </button>

      <!-- Lien pour continuer les achats -->
      <a routerLink="/products" class="continue-shopping">
        ‚Üê Continuer mes achats
      </a>
    </div>

  </div>

</div>
